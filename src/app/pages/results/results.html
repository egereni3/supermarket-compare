<h2>Results for "{{ query }}"</h2>

<p *ngIf="loading">Loading results...</p>
<p *ngIf="!loading && results && !results.sainsburys.length && !results.homebargains.length && !results.morrisons.length">
  No results found.
</p>

<div *ngIf="results">
  <!-- Sainsburys -->
  <div *ngIf="results.sainsburys.length" class="crawler">
    <h3>Sainsburys</h3>
    <ul>
      <li *ngFor="let item of results.sainsburys; let i = index">
        <span>{{ item[0] }}</span>
        <span>{{ item[1] }}</span>

        <div class="quantity-control">
          <button type="button" (click)="quantities['sainsburys'][i] = max1((quantities['sainsburys'][i] || 1) - 1)">−</button>
          <input type="number"
                 min="1"
                 [(ngModel)]="quantities['sainsburys'][i]"
                 (ngModelChange)="normalizeQuantity('sainsburys', i)"
                 [value]="quantities['sainsburys'][i] || 1"
                 class="quantity-input"/>
          <button type="button" (click)="quantities['sainsburys'][i] = (quantities['sainsburys'][i] || 1) + 1">+</button>
        </div>

        <button (click)="onAddClick(item, 'sainsburys', i)"
                [class.pulse]="isAnimating(item, 'sainsburys', i)">
          Add to basket
        </button>
      </li>
    </ul>
  </div>

  <!-- Home Bargains -->
  <div *ngIf="results.homebargains.length" class="crawler">
    <h3>Home Bargains</h3>
    <ul>
      <li *ngFor="let item of results.homebargains; let i = index">
        <span>{{ item[0] }}</span>
        <span>{{ item[1] }}</span>

        <div class="quantity-control">
          <button type="button" (click)="quantities['sainsburys'][i] = max1((quantities['sainsburys'][i] || 1) - 1)">−</button>
          <input type="number"
                 min="1"
                 [(ngModel)]="quantities['homebargains'][i]"
                 (ngModelChange)="normalizeQuantity('homebargains', i)"
                 [value]="quantities['homebargains'][i] || 1"
                 class="quantity-input"/>
          <button type="button" (click)="quantities['homebargains'][i] = (quantities['homebargains'][i] || 1) + 1">+</button>
        </div>

        <button (click)="onAddClick(item, 'homebargains', i)"
                [class.pulse]="isAnimating(item, 'homebargains', i)">
          Add to basket
        </button>
      </li>
    </ul>
  </div>

  <!-- Morrisons -->
  <div *ngIf="results.morrisons.length" class="crawler">
    <h3>Morrisons</h3>
    <ul>
      <li *ngFor="let item of results.morrisons; let i = index">
        <span>{{ item[0] }}</span>
        <span>{{ item[1] }}</span>

        <div class="quantity-control">
          <button type="button" (click)="quantities['sainsburys'][i] = max1((quantities['sainsburys'][i] || 1) - 1)">−</button>
          <input type="number"
                 min="1"
                 [(ngModel)]="quantities['morrisons'][i]"
                 (ngModelChange)="normalizeQuantity('morrisons', i)"
                 [value]="quantities['morrisons'][i] || 1"
                 class="quantity-input"/>
          <button type="button" (click)="quantities['morrisons'][i] = (quantities['morrisons'][i] || 1) + 1">+</button>
        </div>

        <button (click)="onAddClick(item, 'morrisons', i)"
                [class.pulse]="isAnimating(item, 'morrisons', i)">
          Add to basket
        </button>
      </li>
    </ul>
  </div>
</div>